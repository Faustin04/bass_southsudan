---
title: "Survey Dashboard"
subtitle: "2024 IOM South Sudan"
author: "Data & Methods Subteam - Bass Connections"
date: "2024-10-01"
output:
 html_document:
   theme: journal
   toc: true
   toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(readxl)
library(purrr)
library(janitor)
library(forcats)
library(scales)
library(knitr)
library(kableExtra)
library(sjmisc)
library(likert)
library(writexl)

options(digits=2)
```

```{r data, include=FALSE}

# Setting up directory

# Renan
setwd("G:/.shortcut-targets-by-id/1vb8pjBFn0skX769fagfR8mbbt6mXSnjI/Bass Team South Sudan/Sub-Team Folders/1. Methods & Data/")

# Loading and joining data base  
df <- read.csv("Descriptive Analysis/Bass_Team_Data_V2.csv")

```

Total number of respondents: **`r df %>% nrow()`**

All question numbers below are based on the "Key Variables for Descriptive Statistics" doc file.

All the descriptive calculated for index questions were based on the **unimputed** variable.

# 1) Socio-demographics questions

## Languages {.tabset} 

### Entire sample

```{r Languages, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q0.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q0.2, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q0.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q0.2, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q0.2 = factor(Q0.2)) %>%
  ggplot(aes(Q0.2, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q0.2", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Languages by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q0.2) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q0.2, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## County {.tabset} 

### Entire sample

```{r County, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q1.5_County, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q1.5_County, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q1.5_County = factor(Q1.5_County)) %>%
  ggplot(aes(Q1.5_County, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q1.5_County", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

## Payam {.tabset} 

### Entire sample

```{r Payam, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_Payam) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q1.5_Payam, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_Payam) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q1.5_Payam, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q1.5_Payam = factor(Q1.5_Payam)) %>%
  ggplot(aes(Q1.5_Payam, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q1.5_Payam", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Payam by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q1.5_Payam) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q1.5_Payam, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Sex {.tabset} 

### Entire sample

```{r Sex, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.1, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.1) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.1, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.1 = factor(Q2.1)) %>%
  ggplot(aes(Q2.1, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.1", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Sex by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.1) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.1, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Age {.tabset} 

### Entire sample

```{r Age, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.2, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.2) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.2, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.2 = factor(Q2.2)) %>%
  ggplot(aes(Q2.2, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.2", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Age by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.2) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.2, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Which of the following information sources do you rely on most? {.tabset} 

### Entire sample

```{r Source of info, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.8) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.8, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.8) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.8, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.8 = factor(Q2.8)) %>%
  ggplot(aes(Q2.8, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.8", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Source of info by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.8) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.8, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Religion {.tabset} 

### Entire sample

```{r Religion, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.10) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.10, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.10) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.10, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.10 = factor(Q2.10)) %>%
  ggplot(aes(Q2.10, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.10", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Religion by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.10) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.10, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Ethnicity {.tabset} 

### Entire sample

```{r Ethnicity, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q2.11) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q2.11, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q2.11) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q2.11, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q2.11 = factor(Q2.11)) %>%
  ggplot(aes(Q2.11, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q2.11", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

### By county

```{r Ethnicity by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>%
  group_by(Q1.5_County, Q2.11) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q2.11, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

# 2) Human Fragility

All the answers are on a **scale of 0-1**, i.e. can have the following values: 0, 0.25, 0.5, 0.75, 1. The higher, the more fragile.

The higher, the more fragile.

## Index Questions

### Q5.5.1: Over the past year, how often, if ever, have you or anyone in your family gone without enough foor to eat? {.tabset} 

#### Entire sample

```{r Q5.5.1, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q5.5.1_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.1_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q5.5.1_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.1_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q5.5.1_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q5.5.1_raw = factor(Q5.5.1_raw)) %>%
  ggplot(aes(Q5.5.1_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q5.5.1", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q5.5.1 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q5.5.1_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q5.5.1_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q5.5.1_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q5.5.2: Over the past year, how often, if ever, have you or anyone in your family gone without enough clean water for home use? {.tabset} 

#### Entire sample

```{r Q5.5.2, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q5.5.2_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.2_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q5.5.2_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.2_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q5.5.2_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q5.5.2_raw = factor(Q5.5.2_raw)) %>%
  ggplot(aes(Q5.5.2_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q5.5.2", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q5.5.2 by county, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q5.5.2_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q5.5.2_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q5.5.2_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q5.5.3: Over the past year, how often, if ever, have you or anyone in your family gone without necessary medicines or medical treatment? {.tabset} 

#### Entire sample

```{r Q5.5.3, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q5.5.3_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.3_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q5.5.3_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q5.5.3_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q5.5.3_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q5.5.3_raw = factor(Q5.5.3_raw)) %>%
  ggplot(aes(Q5.5.3_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q5.5.3", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q5.5.3 by county, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q5.5.3_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q5.5.3_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q5.5.3_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q7.1: What type of shelter are you currently living in? {.tabset} 

#### Entire sample

```{r Q7.1, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q7.1_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q7.1_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q7.1_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q7.1_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q7.1_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q7.1_raw = factor(Q7.1_raw)) %>%
  ggplot(aes(Q7.1_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q7.1", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q7.1 by county, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q7.1_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q7.1_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q7.1_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q8.5.6: On a scale from 1 to 5, where 1 means “very unfrightened” and 5 means “very frightened,” how afraid are you of the sexual violence in your community? {.tabset} 

#### Entire sample

```{r Q8.5.6, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q8.5.6_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.6_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q8.5.6_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q8.5.6_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q8.5.6_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q8.5.6_raw = factor(Q8.5.6_raw)) %>%
  ggplot(aes(Q8.5.6_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  labs(x = "Q8.5.6", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip()

```

#### By county

```{r Q8.5 by county, eval = TRUE, echo = FALSE, warnings = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q8.5.6_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q8.5.6_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q8.5.6_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Additional Questions

Coming soon...

# 3) Political and Legal Fragility 

All the answers are in a **scale of 0-1**, i.e. can have the following values: 0, 0.25, 0.5, 0.75, 1. The higher, the more fragile.

The higher, the more fragile.

## Index Questions

### Q10.1.2: How much confidence do you have in your state government? {.tabset}

0 (none) to 1 (a lot)

#### Entire sample

```{r Q10.1.2_raw, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |>
  summarize(mean = mean(Q10.1.2_unimputed, na.rm = TRUE)) |>
  kable(align = "lc") |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.1.2_raw) |>
  summarise(answers = n()) |>
  arrange(desc(answers)) |>
  select(Q10.1.2_raw, answers) |>
  mutate(percentage = answers/sum(answers)) |>
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.1.2_raw) |>
  summarise(answers = n()) |>
  arrange(desc(-answers)) |>
  select(Q10.1.2_raw, answers) |>
  mutate(percentage = answers / sum(answers), Q10.1.2_raw = factor(Q10.1.2_raw)) |>
  ggplot(aes(Q10.1.2_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
   geom_text(aes(label = answers), 
            vjust = 0.5,
            hjust = -0.3,
            size = 2.0) +
  labs(x = "Q10.1.2: Trust in State Governments", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  theme_minimal() +
  coord_flip()

```

#### By county

```{r Q10.1.2_raw by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |> 
  group_by(Q1.5_County) |> 
  summarize(mean = mean(Q10.1.2_unimputed, na.rm = TRUE)) |> 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) |>
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q10.1.2_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q10.1.2_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q10.1.10: How much confidence do you have in informal authorities, such as councils of elders? {.tabset}

0 (none) to 1 (a lot)

#### Entire sample

```{r Q10.1.10_raw, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |>
  summarize(mean = mean(Q10.1.10_unimputed, na.rm = TRUE)) |>
  kable(align = "lc") |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.1.10_raw) |>
  summarise(answers = n()) |>
  arrange(desc(answers)) |>
  select(Q10.1.10_raw, answers) |>
  mutate(percentage = answers/sum(answers)) |>
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.1.10_raw) |>
  summarise(answers = n()) |>
  arrange(desc(-answers)) |>
  select(Q10.1.10_raw, answers) |>
  mutate(percentage = answers / sum(answers), Q10.1.10_raw = factor(Q10.1.10_raw)) |>
  ggplot(aes(Q10.1.10_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  geom_text(aes(label = answers), 
            vjust = 0.5,
            hjust = -0.3,
            size = 2.0) +
  labs(x = "Q10.1.10: Trust in Informal Authorities", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  theme_minimal() +
  coord_flip()
```

#### By county

```{r Q10.1.10_raw by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |> 
  group_by(Q1.5_County) |> 
  summarize(mean = mean(Q10.1.10_unimputed, na.rm = TRUE)) |> 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) |>
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q10.1.10_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q10.1.10_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q10.10: South Sudan’s next national elections are scheduled for December 2024 after being postponed several times. How safe or unsafe would you feel going to a polling station to cast your vote? {.tabset}

0 (very unsafe) to 1 (very safe)

#### Entire sample

```{r Q10.10_raw, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |>
  summarize(mean = mean(Q10.10_unimputed, na.rm = TRUE)) |>
  kable(align = "lc") |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.10_raw) |>
  summarise(answers = n()) |>
  arrange(desc(answers)) |>
  select(Q10.10_raw, answers) |>
  mutate(percentage = answers/sum(answers)) |>
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.10_raw) |>
  summarise(answers = n()) |>
  arrange(desc(-answers)) |>
  select(Q10.10_raw, answers) |>
  mutate(percentage = answers / sum(answers), Q10.10_raw = factor(Q10.10_raw)) |>
  ggplot(aes(Q10.10_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  geom_text(aes(label = answers), 
            vjust = 0.5,
            hjust = -0.3,
            size = 2.0) +
  labs(x = "Q10.10: Participation in Democracy Without Fear", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  theme_minimal() +
  coord_flip()

```

#### By county

```{r Q10.10_raw by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |> 
  group_by(Q1.5_County) |> 
  summarize(mean = mean(Q10.10_unimputed, na.rm = TRUE)) |> 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) |>
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q10.10_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q10.10_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q10.12: At present, how safe do you feel speaking publicly on politically sensitive issues? {.tabset}

0(very unsafe) to 1(very safe)

#### Entire sample

```{r Q10.12_raw, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |>
  summarize(mean = mean(Q10.12_unimputed, na.rm = TRUE)) |>
  kable(align = "lc") |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.12_raw) |>
  summarise(answers = n()) |>
  arrange(desc(answers)) |>
  select(Q10.12_raw, answers) |>
  mutate(percentage = answers/sum(answers)) |>
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.12_raw) |>
  summarise(answers = n()) |>
  arrange(desc(-answers)) |>
  select(Q10.12_raw, answers) |>
  mutate(percentage = answers / sum(answers), Q10.12_raw = factor(Q10.12_raw)) |>
  ggplot(aes(Q10.12_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  geom_text(aes(label = answers), 
            vjust = 0.5,
            hjust = -0.3,
            size = 2.0) +
  labs(x = "Q10.12: Freedom of Speech", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  theme_minimal() +
  coord_flip()
```

#### By county

```{r Q10.12_raw by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |> 
  group_by(Q1.5_County) |> 
  summarize(mean = mean(Q10.12_unimputed, na.rm = TRUE)) |> 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) |>
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q10.12_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q10.12_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q10.13: Which of the following statements best describes the role that politicians in Juba play in your community? {.tabset}

0(they make the community much less safe) to 1(they make the community much more safe)

#### Entire sample

```{r Q10.13_raw, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |>
  summarize(mean = mean(Q10.13_unimputed, na.rm = TRUE)) |>
  kable(align = "lc") |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.13_raw) |>
  summarise(answers = n()) |>
  arrange(desc(answers)) |>
  select(Q10.13_raw, answers) |>
  mutate(percentage = answers/sum(answers)) |>
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) |>
  kable_styling(position = "left", full_width = F)

df |>
  group_by(Q10.13_raw) |>
  summarise(answers = n()) |>
  arrange(desc(-answers)) |>
  select(Q10.13_raw, answers) |>
  mutate(percentage = answers / sum(answers), Q10.13_raw = factor(Q10.13_raw)) |>
  ggplot(aes(Q10.13_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7)+
  geom_text(aes(label = answers), 
            vjust = 0.5,
            hjust = -0.3,
            size = 2.0) +
  labs(x = "Q10.13: Trust in National Government", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  theme_minimal() +
  coord_flip()
```

#### By county

```{r Q10.13_raw by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df |> 
  group_by(Q1.5_County) |> 
  summarize(mean = mean(Q10.13_unimputed, na.rm = TRUE)) |> 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) |>
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q10.13_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q10.13_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Additional Questions

Coming soon...

# 4) Environmental Fragility

All the answers are in a **scale of 0-1**, i.e. can have the following values: 0, 0.25, 0.5, 0.75, 1. The higher, the more fragile.

The higher, the more fragile.

Ex:
0 = Not severe at all 
0.25 = Not severe
0.50 = Somewhat severe
0.75 = Severe
1 = Extremely severe

## Index Questions

### Q11.10A Many people in South Sudan have experienced the following: too much rain, too little rain, temperatures that are too high, temperatures that are too low, pests and crop diseases, and deforestation and erosion. How severe would you say the impact of any of these experiences have been on your household income, on a scale from 1 to 5 where 1 means “not severe at all and 5 means “extremely severe?” {.tabset}

#### Entire sample

```{r Q11.10A, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q11.10A_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10A_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.10A_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10A_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.10A_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.10A_raw = factor(Q11.10A_raw)) %>%
  ggplot(aes(Q11.10A_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.10A_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q11.10A by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.10A_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.10A_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.10A_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q11.10B And how severe would you say the impact of any of these experiences have been on your household food consumption?

#### Entire sample

```{r Q11.10B, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q11.10B_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10B_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.10B_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10B_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.10B_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.10B_raw = factor(Q11.10B_raw)) %>%
  ggplot(aes(Q11.10B_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.10B_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q11.10B by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.10B_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.10B_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.10B_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q11.10C And how severe would you say the impact of any of these experiences have been on your household’s ability to choose where you live?

#### Entire sample

```{r Q11.10C, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q11.10C_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10C_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.10C_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10C_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.10C_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.10C_raw = factor(Q11.10C_raw)) %>%
  ggplot(aes(Q11.10C_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.10C_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q11.10C by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.10C_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.10C_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.10C_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q11.10D And how severe would you say the impact of any of these experiences have been on your household’s health?

```{r Q11.10D, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q11.10D_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10D_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.10D_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.10D_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.10D_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.10D_raw = factor(Q11.10D_raw)) %>%
  ggplot(aes(Q11.10D_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.10D_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```

#### By county

```{r Q11.10D by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.10D_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.10D_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.10D_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

### Q11.11 Imagine that there was a flood coming to your town tomorrow. If you knew about this incoming flood before the water arrived, to what extent do you agree with the following statement: “I would be able to use this information to protect my household?”

```{r Q11.11, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  summarize(mean = mean(Q11.11_unimputed, na.rm = TRUE)) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.11_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(answers)) %>%
  select(Q11.11_raw, answers) %>%
  mutate(percentage = answers/sum(answers)) %>%
  kable(align = "lc", 
        col.names = c("Response", "Number of Responses", "Percent of Total Responses")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q11.11_raw) %>%
  summarise(answers = n()) %>%
  arrange(desc(-answers)) %>%
  select(Q11.11_raw, answers) %>%
  mutate(percentage = answers / sum(answers),
         Q11.11_raw = factor(Q11.11_raw)) %>%
  ggplot(aes(Q11.11_raw, answers)) +
  geom_col(binwidth = 0.125, fill = "blue", color = "black", alpha = 0.7) +
  labs(x = "Q11.11_raw", y = "Number of respondents") +
  theme(axis.text.x = element_text(size = 11),
        axis.title.x = element_text(margin = margin(t = 10))) +
  coord_flip() 

```
#### By county

```{r Q11.11 by county, eval = TRUE, warnings = FALSE, echo = FALSE, message = FALSE, out.width="65%"}

df %>% 
  group_by(Q1.5_County) %>% 
  summarize(mean = mean(Q11.11_unimputed, na.rm = TRUE)) %>% 
  kable(align = "lc", col.names = c("County", "Mean Response (0 to 1)")) %>%
  kable_styling(position = "left", full_width = F)

df %>%
  group_by(Q1.5_County, Q11.11_raw) %>%
  summarise(answers = n(), .groups = 'drop') %>%
  arrange(desc(Q1.5_County)) %>%
  group_by(Q1.5_County) %>%
  mutate(percentage = answers / sum(answers)) %>%
  ungroup() %>%
  select(Q1.5_County, Q11.11_raw, answers, percentage) %>%
  kable(align = "lc") %>%
  kable_styling(position = "left", full_width = F)

```

## Additional Questions

Coming soon...
